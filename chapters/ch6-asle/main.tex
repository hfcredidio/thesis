\chapter{Loewner Evolutions of Anisotropic Systems}
\label{ch:asle}

In this work we explore the possibility of using Loewner evolutions to study
anisotropic fractal systems, i.e., systems with different critical exponents in
each direction. These systems are not scale invariant, therefore not
conformally invariant either. We are particularly interested in the two
variants of the percolation model that show anisotropic behavior presented in
Sections~\ref{sec:mlp} and~\ref{sec:dp}, namely, multi-layered percolation and
directed percolation. Precisely,  we generate the border of percolating
clusters (see Figure~\ref{fig:models}), numerically compute their corresponding
driving function, and then analyze the diffusive properties of these numerical
sequences. In the general case, we expect that the mean square displacement of
$U_t$ behaves like,
\begin{equation}
    \label{eq:diff}
    \left\langle U_t^2 \right\rangle \rightarrow b t^\alpha
\end{equation} 
as $t\rightarrow\infty$. In the case of traditional SLE, $\alpha=1$ and
$b=\kappa$.  The driving functions of anisotropic percolation models, we found,
display very distinctive anomalous diffusive behavior ($\alpha\neq1$). We also
look at the presence of long range correlations in the driving function using
the detrended fluctuation analysis (DFA). Finally, we show that our approach is
also valid in the opposite direction, that SLE consistently leads
anomalously diffusive driving functions to traces that display clear
anisotropic scaling. To test that, we generate Loewner traces driven by
fractional Brownian motions with different values of $b$ and $H=\alpha/2$,
which we'll refer as $SLE(b,H)$, and compare the scaling properties of the
traces obtained with those of the lattice models.


\section{Methods}
\label{sec:methods}

Before delving into our results, we shall give a brief overview of some of the
most important methods used in the simulation and analysis of both traces
and driving functions.

\subsection{Generating Large Percolation Traces}
\label{sec:hulls}

Simulating the percolation process and extracting the percolating cluster
perimeter is very straightforward and a number of good algorithms are
available. However, because of the spotty behavior of the zipper algorithm (see
Fig.~\ref{fig:eulerzip}) in the high $\kappa$ ($>4$) domain, we need very large
traces in order to obtain reliable results. The usual algorithms are normally
very memory hungry because you need to store the state of all sites of the
lattice. Since we are only interested in obtaining the perimeter of the
percolating cluster, which consists of only a small portion of the lattice, one
might imagine if there's a more efficient way of simulating these curves.
Luckily there is, thanks to the locality property of the percolation model. The
method is called the \textit{percolation exploration process}~\cite{Cardy2005}.

The exploration process is easier to define in the triangular lattice, because
at any given time the walker is always facing a single site, unlike the square
lattice, in which it faces two sites at once, complicating things a little (it
doesn't make it impossible, though). In the exploration process, a walker is
put in an initial position at the bottom of the lattice. The walker observes
the state of the site right in front of him. If it is unoccupied, the walker
turns clockwise, otherwise it turns clockwise. Then the walker takes a step in
the direction it is facing. This process is then repeated until one obtain a
curve long enough. The algorithm guarantees that the curve will not
self-intersect and will not get trapped.

Because we restrict ourselves to chordal SLE, the walker can never leave the
upper-half plane. To assure this, we impose closed boundary conditions in which
the left side of the bottom row of the lattice is always unoccupied and the
right side is always occupied. This way the trace will always turn away from
the real line.

It's pretty clear the advantage of this method, you only need to store the
information about the sites directly adjacent to the perimeter, which can be
cached in your container of preference, like a hash table (also known as maps
or dictionaries), as illustrated in Figure~\ref{fig:explore}. This allow us to
simulate traces with up to million points. In fact we could easily go above
that, the limiting factor being the time the zipper algorithm takes to compute
the driving function.

We used the exploration process to generate the traces for isotropic and
multi-layered percolation in a triangular lattice. However, the critical point
of multi-layered percolation have not yet been determined in the triangular
lattice. To compute $p_c(\Delta)$ we made use the cluster perimeter
method~\cite{Ziff1986}. We basically use the exploration process with no
boundary condition to generate curves until they form a loop. If the loop is
formed clockwise, this means it represents the perimeter of a hole inside a
cluster. If it is counterclockwise, it means the curve is the outside perimeter
of cluster. On the critical point, the probability that a loop is internal or
external is the same. We found, somewhat surprisingly, that in the triangular
lattice, $p_c=0.5$ for every value of $\Delta$, unlike the square lattice, as
shown in Figure~\ref{fig:mlp_ps}.

This algorithm is not appropriate for the simulation of directed percolation
traces, because the occupation probability of any given site is not independent
from its neighbors. In this case we decided for a more standard approach,
growing a cluster using a graph data structure to save memory, and finding the
perimeter using a simple walker algorithm, where the trace is the trajectory of
a particle that moves along the border of the cluster while keeping the cluster
always at to right hand side.

\begin{figure}
\begin{center}
    \includegraphics[scale=0.45]{chapters/ch6-asle/figs/explore}
\end{center}
\caption{The first few steps of a percolation exploration process with closed
    boundary conditions in a triangular lattice, which means the left side of
    the bottom row is always unoccupied (yellow) and the right side is always
    occupied (blue). At each step, the walker checks the status of the site
    right in front of it. If it is yellow, the walker turns clockwise and takes
    a step. If it is blue it turns counter-clockwise before taking a step. This
    method is superior because you only need to store the information about the
    sites adjacent to the curve, saving RAM and allowing for simulations of
    very large traces.}
\label{fig:explore}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{chapters/ch6-asle/figs/models}
\end{center}
\caption{Percolation models used to generate the SLE curves. Isotropic
    percolation (left), where each site is occupied with the same probability
    $p$. Multi-layered percolation (middle), where some rows are occupied with
    probability $p+\Delta$ (dark gray rows) and others with $p-\Delta$ (light
    gray rows). Directed percolation (right) is a spreading process which
    starts at the bottom of the tilted lattice and can only advance upwards
    with probability $p$. The trace is defined as the perimeter of the
    percolating cluster.}
\label{fig:models}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[width=0.7\textwidth]{chapters/ch6-asle/figs/mlp_ps}
\end{center}
\caption{Critical point of multi-layered percolation as computed using the
    cluster perimeter method. This is done by generating several percolation
    perimeters without boundary conditions until they form a loop. In the
    critical point the loop has equal probabilities of being a internal or
    external perimeter. We found that in the triangular lattice, $p_c=0.5$
    for every value of $\Delta$, unlike the square lattice.}
\label{fig:mlp_ps}
\end{figure}



\subsection{Detrended Fluctuation Analysis}
\label{sec:dfa}

We want to test whether or not the driving functions present long range
correlations. Other works have shown that some form of anisotropy can be
observed in SLE traces driven by L\'evy processes. We have good reasons to
believe this is not the case for multi-layered and directed percolation,
because L\'evy processes do not show subdiffusion and they generate
discontinuous traces.

In order to close the issue we perform one last test: check for the presence of
long range correlations. To do that we employ a method called Detrended
Fluctuation Analysis (DFA for short), which is an adaptation of an older
algorithm called simply Fluctuation Analysis. It is specially designed for the
analysis of non stationary series~\cite{Peng1993, Hardstone2012}.

Given a time series of $N$ data points $\{x_i\}$, we first generate a random walk
out of it by making the cumulative profile of the series
\begin{equation}
    X_i = \sum_{i=1}^{N} \left({x_i - \left\langle x \right\rangle}\right).
\end{equation}
The accumulated series is then divided in $m$ non overlapping partitions, each with
$s = N/m$ elements. In case $N$ is not divisible by $m$ we can still make use
of the last elements of the series by taking $s=\left\lfloor N/m\right\rfloor$
and reflecting it in the end the following way
\begin{equation}
    X\rightarrow\left\{X_1, \ldots, X_{ms},
                       X_{N}, X_{N - 1}, \ldots,
                       X_{N - ms}\right\}.
\end{equation}
In this case we actually changed the series size to $N\rightarrow2ms$ and the
number of intervals to $m\rightarrow2m$, so this should be taken in account in
later equations. This step is optional, but useful in order to use all the
information embedded in the time series.

We then determined the trend of each partition by fitting them separately using
a polynomial of degree $v$. Usually a first or second degree polynomial is
chosen. The series is detrended by taking the difference of the signal value and
the trend 
\begin{equation}
    Y_i = \sum_{i=1}^{N} X_i - f_v(i),
\end{equation}
where $f_v(i)$ is the value of the trend in the point $i$. We define the fluctuation
function as the standard deviation of the detrended signal, which is a function
of the number of points $s$ in each partition of the time series
\begin{equation}
    F(s) = \sqrt{\frac{1}{N}\sum_{i=1}^{N}Y_i}.
\end{equation}

A plot of $F(s)$ vs. $s$ in a log-log scale should show a straight line for
well a behaved series (see Fig.~\ref{fig:dfa}). The Hurst exponent of the
series can be determined by fitting the fluctuation function with a power law
\begin{equation}
    F(s)\sim s^H.
\end{equation}

\begin{figure}[t]
    \begin{center}
        \includegraphics[scale=0.25]{chapters/ch6-asle/figs/dfa}
    \end{center}
    \caption{The Detrended Fluctuation Analysis (DFA) of a time series of
        $N=16,384$ data points. First we divided the series in $m$ partitions with
        $s$ points each (top-left), then fitted each separately with a first order
        polynomial $f_1(i)$ (red lines), obtaining the detrended series by subtracting
        the signal by the trend (top-right).  The fluctuation function (the standard
        deviation of the detrended signal) is computed for various values of $s$
        (bottom).  The Hurst exponent is then determined by fitting the fluctuation
        function with a power law $F(s)\sim s^h$.}
\label{fig:dfa}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[scale=0.45]{chapters/ch6-asle/figs/dfaresults}
\end{center}
\caption{Results of detrended fluctuation analysis (DFA) of the driving
    functions of percolation models. As expected, the driving function of the
    isotropic percolation (top left) is a Brownian motion, therefore have
    $H=0.5$. For comparison the DFA of L\'evy flights with several $\alpha$ is
    shown (top right). Despite displaying anomalous diffusion, it still have
    $H=0.5$. Multi-layered percolation however shows a very distinct exponent
    $H=0.814$, which is consistent with the diffusion exponent shown inf
    Figure~[???]. The fluctuation function of directed percolation does not
    have a power-law behavior, [???].}
\label{fig:dfaresults}
\end{figure}


\subsection{Generating Fractional Brownian Motions}
\label{sec:fbm}

We want to generate fractional Brownian motions $B_t$ such that
\begin{equation}
    \label{eq:fbm}
    \left\langle B_t^2 \right\rangle = bt^{2H}.
\end{equation}
There are several methods to generate this process numerically, but not all of
them give you ample control over the prefactor $b$, although most are very
accurate in $H$. A method that adequately fulfills this criterion is the
Davies-Harte algorithm~\cite{Davies1987}. It can be used to generate any
stationary Gaussian process for which the autocovariance sequence is known. In
the case of the fractional Brownian motion, it takes the form
\begin{equation}
    c_i = \frac{b}{2} \left(
            \left|i+1\right|^{2H} +
            \left|i-1\right|^{2H} -
            2\left|i\right|^{2H}
          \right)
\end{equation}

To obtain a series of length $N$ we generate the following sequence of $2N$
points
\begin{equation}
    s_i=\left\{c_{0},c_{1},\ldots,c_{N},c_{N-1},\ldots,c_{1}\right\}
\end{equation}
and compute its discrete Fourier transform, that is
\begin{equation}
    g_{i}=\sum_{j}s_{j}e^{-i\pi kj/N}.
\end{equation}
This operation can be done in $O(N\log N)$ operations using a fast Fourier
transform~\cite{Frigo2002}. The $g_i$ are real valued, but a necessary condition for the
Davies-Harte algorithm to work is that they also be nonnegative. It is
important to check for this condition even if just for debugging purposes,
as it catches a lot of small mistakes.

Let $W_{i\in[0,N]}$ be a sequence of $N+1$ random complex numbers where the
real and imaginary parts are independently distributed according to a normal
distribution with zero mean and unit variance. We then construct the series
\begin{equation}
    Y_{i\in[0,2N-1]}=\begin{cases}
        \sqrt{2Ng_{i}}\mbox{Re}\left\{ W_{i}\right\}  & \mbox{if } i=0,N\\
        \sqrt{Ng_{i}}W_{i} & \mbox{if } i\in\left[1, N-1\right]\\
        \sqrt{Ng_{i}}W_{2N-i}^{*} & \mbox{if } i\in\left[N+1, 2N-1\right]
    \end{cases},
\end{equation}
where $W^{*}$ is the complex conjugate. The fractional Brownian motion $B_t$ is
obtained by computing the inverse Fourier transform of this series. Although
the obtained series have $2N$ points we discard the second half, as it is not
guaranteed to be well behaved. The $B_t$ are defined for $t\in{0,1,\ldots,N-1}$,
but the series can easily be rescaled for any timespan desirable by applying
the relation
\begin{equation}
    B_{t\in[0,t_{f}]}={\left(\frac{t_{f}}{N}\right)}^{H}B_{t\in[0,N]}.
\end{equation}

In Figure~\ref{fig:fbm}, we show some examples of fractional Brownian motion
generated using this algorithm. We also show that the mean squared displacement
behaves as described by Eq.~\ref{eq:fbm}.

\begin{figure}
\begin{center}
    \includegraphics[scale=0.45]{chapters/ch6-asle/figs/fbm}
\end{center}
\caption{Example of three fractional Brownian motions generated using the
    Davies-Harte algorithm (left). They all have $b=1.0$ and different values
    of $H$. We also show the behavior of the mean square displacement of the
    scaling properties of the curves. We found that the mean square displacement
    scales as $\sqrt{\left\langle B_t^2\right\rangle}=\sqrt{b}t^H$ with
    parameters very similar to the input given.}
\label{fig:fbm}
\end{figure}


\section{Results and Discussion}
\label{sec:scaling}

We started by generating an ensemble of $10^4$ percolation perimeters for each
of the models studied. We then used the Zipper algorithm, parallelized on
G

To compute the traces we used a na\"\i{}ve parallelization of the Zipper algorithm
described in Section [???], where each thread compute a single point of the trace.


\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{chapters/ch6-asle/figs/diffusion}
\end{center}
\caption{Mean squared displacement of the driving functions for the three
    percolation models studied. The curves are the results of the numerical
    procedure described in the text applied to $10^4$ realizations of each type
    of percolation model. As expected, in the case of isotropic percolation,
    the displacement scales linearly with time, while it shows instead a
    distinctive subdiffusive behavior for directed percolation, with an
    exponent $\alpha\approx0.67$. In the case of multi-layered percolation, a
    clear superdiffusive behavior, with an exponent $\alpha\approx1.79$, can be
    observed for $\Delta=0.4$. The left graph shows this anomalous diffusion
    regime is gradually achieved as we increase the degree of anisotropy
    $\Delta$.}
\label{fig:diffusion}
\end{figure}


\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{chapters/ch6-asle/figs/spacescaling}
\end{center}
\caption{Root mean squared estimations of the displacements in the X and
    Y-directions of SLE traces driven by long-range power-law correlated time
    series (fractional Brownian motion). The simulation parameters (H, b and
    tf) were chosen based on the results shown in Fig.~\ref{fig:diffusion} (see
    Table~\ref{tab:param} for the numerical values). Good agreement is
    observed between the uncorrelated result ($H=0.5$) and isotropic percolation,
    as it is expected. The correlated trails ($H=0.8$) are also compatible with
    multi-layered percolation (inset on the bottom). In the anti-correlated
    case ($H=0.33$), the same kind of anisotropy present in the directed
    percolation is observed, however the exponents are not an exact match.
    These results support our hypothesis that long-term correlations in the
    driving functions, i.e., the presence of anomalous diffusion, are
    responsible for the anisotropic behavior of the traces. For the values of
    the exponents found, see Table~\ref{tab:nus}.}
\label{fig:spacescaling}
\end{figure}


\begin{figure}
\begin{center}
    \includegraphics[width=0.9\textwidth]{chapters/ch6-asle/figs/timescaling}
\end{center}
\caption{Scaling analysis of the percolation models and their SLE equivalents.
    Here we observe how the total width, $X(t)$, and and height, $Y(t)$, of the
    traces evolve in time. According to the SLE time.}
\label{fig:timescaling}
\end{figure}


\begin{figure}
\begin{center}
    \includegraphics[scale=0.5]{chapters/ch6-asle/figs/asle_traces}
\end{center}
\caption{Examples of $SLE(b,H)$ generate using the three sets of parameters
    that we drew from the diffusion analysis (Figure~[???]). For the correlated
    ($H>0.5$) and uncorrelated ($H=0.5$) we show one example of each. In the
    anticorrelated we show several instances. We used the zipper algorithm with
    $10^6$ points equally spaced in the interval $t\in[0, t_f]$, where the
    values of $t_f$ used can be found in Table~[???].}
\label{fig:asle_traces}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[scale=0.5]{chapters/ch6-asle/figs/ip_trdr}
\end{center}
\caption{Example of a cluster perimeter of the isotropic percolation model in
    the triangular lattice with a detail shown. The bottom graph is the driving
    function obtained by applying the zipper algorithm to this trace.}
\label{fig:ip_trdr}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[scale=0.5]{chapters/ch6-asle/figs/ml_trdr}
\end{center}
\caption{Example of a cluster perimeter of the multi-layered percolation model
    in the triangular lattice ($\Delta=0.2$) with a detail shown. The bottom
    graph is the driving function obtained by applying the zipper algorithm to
    this trace.}
\label{fig:ml_trdr}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[scale=0.5]{chapters/ch6-asle/figs/dp_trdr}
\end{center}
\caption{Example of a cluster perimeter of the bond directed percolation model
    in the square lattice with a detail shown. The bottom graph is the driving
    function obtained by applying the zipper algorithm to this trace.}
\label{fig:dp_trdr}
\end{figure}

\input{chapters/ch6-asle/table.tex}
\input{chapters/ch6-asle/table2.tex}
\input{chapters/ch6-asle/table3.tex}
